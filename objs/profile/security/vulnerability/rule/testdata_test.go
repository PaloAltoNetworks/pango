package rule

import (
	"github.com/PaloAltoNetworks/pango/version"
)

type tc struct {
	desc    string
	version version.Number
	conf    Entry
}

func getTests() []tc {
	return []tc{
		{"v1 default", version.Number{6, 1, 0, ""}, Entry{
			Name:          "first",
			ThreatName:    "some threat",
			Cves:          []string{"cve1", "cve2"},
			Host:          HostAny,
			VendorIds:     []string{"any"},
			Severities:    []string{"critical", "high"},
			Category:      "dos",
			Action:        ActionDefault,
			PacketCapture: PacketCaptureDisable,
		}},
		{"v1 allow", version.Number{6, 1, 0, ""}, Entry{
			Name:          "two",
			ThreatName:    "some threat",
			Cves:          []string{"cve1"},
			Host:          HostClient,
			VendorIds:     []string{"id1", "id2"},
			Severities:    []string{"informational"},
			Category:      "brute-force",
			Action:        ActionAllow,
			PacketCapture: PacketCaptureSingle,
		}},
		{"v1 alert", version.Number{6, 1, 0, ""}, Entry{
			Name:          "three",
			ThreatName:    "some threat",
			Cves:          []string{"cve1"},
			Host:          HostServer,
			VendorIds:     []string{"id3", "id1", "id2"},
			Severities:    []string{"any"},
			Category:      "exploit-kit",
			Action:        ActionAlert,
			PacketCapture: PacketCaptureExtended,
		}},
		{"v1 block", version.Number{6, 1, 0, ""}, Entry{
			Name:          "four",
			ThreatName:    "some threat",
			Cves:          []string{"cve1", "cve2"},
			Host:          HostAny,
			VendorIds:     []string{"any"},
			Severities:    []string{"any"},
			Category:      "phishing",
			Action:        ActionBlock,
			PacketCapture: PacketCaptureDisable,
		}},
		{"v2 default", version.Number{7, 0, 0, ""}, Entry{
			Name:          "first",
			ThreatName:    "some threat",
			Cves:          []string{"cve1", "cve2"},
			Host:          HostAny,
			VendorIds:     []string{"any"},
			Severities:    []string{"critical", "high"},
			Category:      "dos",
			Action:        ActionDefault,
			PacketCapture: PacketCaptureDisable,
		}},
		{"v2 allow", version.Number{7, 0, 0, ""}, Entry{
			Name:          "two",
			ThreatName:    "some threat",
			Cves:          []string{"cve1"},
			Host:          HostClient,
			VendorIds:     []string{"id1", "id2"},
			Severities:    []string{"informational"},
			Category:      "brute-force",
			Action:        ActionAllow,
			PacketCapture: PacketCaptureSingle,
		}},
		{"v2 alert", version.Number{7, 0, 0, ""}, Entry{
			Name:          "three",
			ThreatName:    "some threat",
			Cves:          []string{"cve1"},
			Host:          HostServer,
			VendorIds:     []string{"id3", "id1", "id2"},
			Severities:    []string{"any"},
			Category:      "exploit-kit",
			Action:        ActionAlert,
			PacketCapture: PacketCaptureExtended,
		}},
		{"v2 drop", version.Number{7, 0, 0, ""}, Entry{
			Name:          "four",
			ThreatName:    "some threat",
			Cves:          []string{"cve1", "cve2"},
			Host:          HostAny,
			VendorIds:     []string{"any"},
			Severities:    []string{"any"},
			Category:      "phishing",
			Action:        ActionDrop,
			PacketCapture: PacketCaptureDisable,
		}},
		{"v2 reset client", version.Number{7, 0, 0, ""}, Entry{
			Name:          "four",
			ThreatName:    "some threat",
			Cves:          []string{"cve1", "cve2"},
			Host:          HostAny,
			VendorIds:     []string{"any"},
			Severities:    []string{"any"},
			Category:      "phishing",
			Action:        ActionResetClient,
			PacketCapture: PacketCaptureDisable,
		}},
		{"v2 reset server", version.Number{7, 0, 0, ""}, Entry{
			Name:          "four",
			ThreatName:    "some threat",
			Cves:          []string{"cve1", "cve2"},
			Host:          HostAny,
			VendorIds:     []string{"any"},
			Severities:    []string{"any"},
			Category:      "phishing",
			Action:        ActionResetServer,
			PacketCapture: PacketCaptureDisable,
		}},
		{"v2 reset both", version.Number{7, 0, 0, ""}, Entry{
			Name:          "four",
			ThreatName:    "some threat",
			Cves:          []string{"cve1", "cve2"},
			Host:          HostAny,
			VendorIds:     []string{"any"},
			Severities:    []string{"any"},
			Category:      "phishing",
			Action:        ActionResetBoth,
			PacketCapture: PacketCaptureDisable,
		}},
		{"v2 block ip", version.Number{7, 0, 0, ""}, Entry{
			Name:            "four",
			ThreatName:      "some threat",
			Cves:            []string{"cve1", "cve2"},
			Host:            HostAny,
			VendorIds:       []string{"any"},
			Severities:      []string{"any"},
			Category:        "phishing",
			Action:          ActionBlockIp,
			BlockIpTrackBy:  BlockIpTrackBySrc,
			BlockIpDuration: 42,
			PacketCapture:   PacketCaptureDisable,
		}},
	}
}
