package exception

import (
	"github.com/PaloAltoNetworks/pango/version"
)

type tc struct {
	desc    string
	version version.Number
	conf    Entry
}

func getTests() []tc {
	return []tc{
		{"v1 default", version.Number{6, 1, 0, ""}, Entry{
			Name:          "first",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionDefault,
			TimeInterval:  42,
		}},
		{"v1 allow", version.Number{6, 1, 0, ""}, Entry{
			Name:          "two",
			PacketCapture: PacketCaptureSingle,
			Action:        ActionAllow,
			TimeThreshold: 512,
			ExemptIps:     []string{"192.168.55.44"},
		}},
		{"v1 alert", version.Number{6, 1, 0, ""}, Entry{
			Name:          "three",
			PacketCapture: PacketCaptureExtended,
			Action:        ActionAlert,
			TimeTrackBy:   TrackBySrc,
		}},
		{"v1 drop", version.Number{6, 1, 0, ""}, Entry{
			Name:          "four",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionDrop,
			TimeInterval:  42,
			TimeThreshold: 1024,
			TimeTrackBy:   TrackByDest,
		}},
		{"v1 drop all", version.Number{6, 1, 0, ""}, Entry{
			Name:          "four",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionDropAll,
		}},
		{"v1 reset client", version.Number{6, 1, 0, ""}, Entry{
			Name:          "four",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionResetClient,
		}},
		{"v1 reset server", version.Number{6, 1, 0, ""}, Entry{
			Name:          "four",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionResetServer,
		}},
		{"v1 reset both", version.Number{6, 1, 0, ""}, Entry{
			Name:          "four",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionResetBoth,
		}},
		{"v1 block ip", version.Number{6, 1, 0, ""}, Entry{
			Name:            "four",
			PacketCapture:   PacketCaptureDisable,
			Action:          ActionBlockIp,
			BlockIpTrackBy:  TrackBySrc,
			BlockIpDuration: 42,
		}},
		{"v2 default", version.Number{7, 0, 0, ""}, Entry{
			Name:          "first",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionDefault,
			TimeInterval:  42,
		}},
		{"v2 allow", version.Number{7, 0, 0, ""}, Entry{
			Name:          "two",
			PacketCapture: PacketCaptureSingle,
			Action:        ActionAllow,
			TimeThreshold: 512,
			ExemptIps:     []string{"192.168.55.44"},
		}},
		{"v2 alert", version.Number{7, 0, 0, ""}, Entry{
			Name:          "three",
			PacketCapture: PacketCaptureExtended,
			Action:        ActionAlert,
			TimeTrackBy:   TrackBySrc,
		}},
		{"v2 drop", version.Number{7, 0, 0, ""}, Entry{
			Name:          "four",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionDrop,
			TimeInterval:  42,
			TimeThreshold: 1024,
			TimeTrackBy:   TrackByDest,
		}},
		{"v2 reset client", version.Number{7, 0, 0, ""}, Entry{
			Name:          "four",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionResetClient,
		}},
		{"v2 reset server", version.Number{7, 0, 0, ""}, Entry{
			Name:          "four",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionResetServer,
		}},
		{"v2 reset both", version.Number{7, 0, 0, ""}, Entry{
			Name:          "four",
			PacketCapture: PacketCaptureDisable,
			Action:        ActionResetBoth,
		}},
		{"v2 block ip", version.Number{7, 0, 0, ""}, Entry{
			Name:            "four",
			PacketCapture:   PacketCaptureDisable,
			Action:          ActionBlockIp,
			BlockIpTrackBy:  TrackBySrc,
			BlockIpDuration: 42,
		}},
	}
}
